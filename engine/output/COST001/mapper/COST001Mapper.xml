<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dowinsys.cost.monthly.COST001Mapper">

    <!-- COST001 조회 -->
    <select id="search" resultType="map">
        SELECT
        base_ym,
        dept_code,
        account_code,
        current_amount,
        previous_amount,
        variance_amount,
        variance_rate
        FROM doi_cost_monthly_dept_cost
        WHERE 1=1
        AND base_ym = #{baseYm}
        <if test="deptCode != null and deptCode != ''">
            AND dept_code = #{deptCode}
        </if>
        <if test="accountCode != null and accountCode != ''">
            AND account_code = #{accountCode}
        </if>
        ORDER BY reg_dt DESC
    </select>

    <!-- COST001 생성 -->
    <insert id="create" parameterType="map">
        INSERT INTO doi_cost_monthly_dept_cost (
        base_ym,
        dept_code,
        account_code,
        current_amount,
        previous_amount,
        variance_amount,
        variance_rate
        ) VALUES (
        #{baseYm},
        #{deptCode},
        #{accountCode},
        #{currentAmount},
        #{previousAmount},
        #{varianceAmount},
        #{varianceRate}
        )
    </insert>

    <!-- COST001 수정 -->
    <update id="update" parameterType="map">
        UPDATE doi_cost_monthly_dept_cost
        SET
            base_ym = #{baseYm},
            dept_code = #{deptCode},
            account_code = #{accountCode},
            current_amount = #{currentAmount},
            previous_amount = #{previousAmount},
            variance_amount = #{varianceAmount},
            variance_rate = #{varianceRate}
        WHERE id = #{id}
    </update>

    <!-- COST001 삭제 -->
    <delete id="delete" parameterType="string">
        DELETE FROM doi_cost_monthly_dept_cost
        WHERE id = #{id}
    </delete>

</mapper>
